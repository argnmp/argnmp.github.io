<!DOCTYPE html>
<html lang="en">
    <head>
        <title class="ground">boj 4991 로봇 청소기</title>
        
        <meta class="ground" name="title" content="boj 4991 로봇 청소기">
        <meta class="ground" name="description" content="문제 [ https:&#x2F;&#x2F;www.acmicpc.net&#x2F;problem&#x2F;4991 ] 풀이 #include &lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;climits&gt; #include &lt;vector&gt; #include &lt;queue&gt; #include &lt;map&gt; #include &lt;unordered_map&gt; #include &lt;set&gt; #include &lt;unordered_set&gt; #include &lt;bitset&gt; #include &lt;cstring&gt; #include &lt;cmath&gt; using namespace std; using ll = long long; ">
        <meta name="robots" content="index,nofollow">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta class="ground" property="og:type" content="website" />
        <meta class="ground" property="og:title" content="boj 4991 로봇 청소기" />
        <meta class="ground" property="og:description" content="문제 [ https:&#x2F;&#x2F;www.acmicpc.net&#x2F;problem&#x2F;4991 ] 풀이 #include &lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;climits&gt; #include &lt;vector&gt; #include &lt;queue&gt; #include &lt;map&gt; #include &lt;unordered_map&gt; #include &lt;set&gt; #include &lt;unordered_set&gt; #include &lt;bitset&gt; #include &lt;cstring&gt; #include &lt;cmath&gt; using namespace std; using ll = long long; " />
        <meta class="ground" property="og:image" content="" />

        <link rel="icon" href="data:,">
        <link href="/static/main.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
        <script src="/static/entry_bundle.js"></script>
        <script src="/static/module_bundle.js" type="module"></script>
    </head>
    <body class="dark:bg-gray-800 font-default">
        <div class="container p-5 mx-auto py-5 box-border h-screen w-screen">
            <div class="flex text-customlight-700 dark:text-customdark-400 mb-4 border-b border-customlight-700 dark:border-customdark-400">
                <div class="grow flex flex-col justify-center items-start">
                    <a class="inline-block" href="/">
                        <p class="text-xl font-bold px-2 bg-customlight-700 text-white dark:bg-customdark-400 dark:text-gray-800 rounded">
                        blog.argnmp
                        </p>
                    </a>
                </div>
                <button id="searchToggle" class="cursor-pointer justify-center items-center p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 stroke-gray-600 dark:stroke-gray-400"
                        viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
                        <path d="M21 21l-6 -6" />
                    </svg>
                </button>
                <button id="toggle" class="cursor-pointer justify-center items-center p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="dark:hidden w-4 h-4" viewBox="0 0 16 16">
                        <path class="fill-gray-600" d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden dark:block w-4 h-4" viewBox="0 0 16 16">
                        <path class="fill-gray-400" d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
                        <path class="fill-gray-400" d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
                    </svg>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-15 gap-2">
                <div class="md:col-span-3">
                    <div class="flex md:flex-col text-gray-900 dark:text-gray-200">
                        <div class="w-full md:object-center basis-1/4">
                          <img class="w-full max-w-sm mx-auto rounded-md ring-customlight-600 dark:ring-customdark-500" src="/static/profile image.png" />
                        </div>
                        <div class="grow pl-4 md:p-0 md:text-left my-auto">
                          <p class="text-xl md:mt-3 mb-2 font-bold">argnmp</p>
                          
                          <p class="text-xs">컴퓨터공학 관련 주제를 주로 다룹니다.</p>
                          
                          <p class="text-xs">argnmp@gmail.com</p>
                          
                          
                          
                          <p class="text-xs"><a class="text-xs" href="https://github.com/argnmp">github</a></p>
                          
                        </div>
                    </div>
                    <div id="toc" class="sticky top-5 mt-5 border-l-2">
                        <p class="pl-4 pb-1 text-sm text-gray-900 dark:text-gray-200 cursor-pointer hover:text-custom-light-700 dark:hover:text-custom-light-400 hover:font-bold hover:underline" hidden>to load styles for dynamically created elements</ul>
                    </div>
                </div>
                <div id="main" class="ground grid-flow-row md:col-span-12 rounded-lg">
                    <div id="searchModule" class="md:pl-3" hidden>
                        <div class="pb-2">
                            <form class="flex">
                                <input type="text" name="search" id="search_input" class="inline w-full rounded-md border-0 py-1 px-2 text-gray-900 ring-1 ring-inset ring-gray-100 dark:ring-gray-700 placeholder:text-gray-400 focus:ring-1 focus:ring-inset focus:ring-customlight-600 dark:focus:ring-customdark-300 text-sm sm:leading-6 dark:bg-gray-800 dark:text-gray-200" placeholder="search for child nodes..." onkeyup="window.search()">
                            </form>
                        </div>
                        <div class="" id="search_result">
                            <a class="" href="">
                                <div class="mb-1 px-2 py-1 border border-gray-200 dark:border-gray-600 dark:text-gray-200 hidden">
                                </div> 
                            </a>
                        </div> 
                    </div>
                    
                    
                    <article>
                        <section class="w-full mb-8">
                            <div class="mb-2 md:pl-5">
                                <p class="text-4xl md:text-[40px] break-keep font-semibold text-gray-700 dark:text-gray-200 py-1 leading-tight">boj 4991 로봇 청소기</p>
                                
                            </div>
                            <div class="flex flex-row mb-2 md:pl-5 text-gray-500 dark:text-gray-400">
                                <div class="mr-2"><p class="text-xs italic">Taehyeon Kim</p></div>
                                <div class="mr-2"><p class="text-xs">·</p></div>
                                <div class="mr-2"><p class="text-xs italic">2024-01-28</p></div>
                                <div class="mr-2"><p class="text-xs"></p></div>

                                <div class="bg-customlight-100 bg-customlight-200 bg-customlight-300 bg-customlight-400 bg-customlight-500 bg-customlight-600 bg-customlight-700 bg-customlight-800 bg-customlight-900 dark:bg-customdark-100 dark:bg-customdark-200 dark:bg-customdark-300 dark:bg-customdark-400 dark:bg-customdark-500 dark:bg-customdark-600 dark:bg-customdark-700 dark:bg-customdark-800 dark:bg-customdark-900" hidden></div>
                                <div class="mr-2 flex flex-row">
                                    
                                    
                                        <div class="px-1 mr-1 bg-customlight-700 text-white dark:bg-customdark-400 dark:text-gray-800 align-middle text-xs rounded-md">
                                            boj
                                        </div>
                                    
                                        <div class="px-1 mr-1 bg-customlight-700 text-white dark:bg-customdark-400 dark:text-gray-800 align-middle text-xs rounded-md">
                                            ps
                                        </div>
                                    
                                    
                                </div>
                            </div>
                        </section>
                        <div class="clear-none markdown-body mb-10 md:pl-5 leading-6 font-post">
                            <h3 id="문제">문제</h3>
<p>[https://www.acmicpc.net/problem/4991]</p>
<h3 id="풀이">풀이</h3>
<pre><code class="language-c++">#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;climits&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;map&gt;
#include &lt;unordered_map&gt;
#include &lt;set&gt;
#include &lt;unordered_set&gt;
#include &lt;bitset&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
using namespace std;
using ll = long long;
int w, h;
char board[20][20];
int dx[4] = {0, 1, -1, 0};
int dy[4] = {1, 0, 0, -1};
struct pos{
    int x, y;
    pos adj(int i){ return {x+dx[i%4], y+dy[i%4]}; }
    bool safe(){ return 0&lt;=x&amp;&amp;x&lt;h&amp;&amp;0&lt;=y&amp;&amp;y&lt;w; }
};
vector&lt;pos&gt; points(1);
int done[20][20] = {0,};
void bfs(int target){
    memset(done, -1, sizeof(done));
    pos p = points[target];
    queue&lt;pos&gt; q;
    q.push(p);
    done[p.x][p.y] = 0;
    while(!q.empty()){
        pos cur = q.front();
        q.pop();
        for(int i = 0; i&lt;4; i++){
            pos next = cur.adj(i);
            if(next.safe() &amp;&amp; board[next.x][next.y]!='x' &amp;&amp; done[next.x][next.y]==-1){
                done[next.x][next.y] = done[cur.x][cur.y] + 1;
                q.push(next);
            }
        }
    }
}

struct edge{
    int v, dist;
};

int graph[11][11] = {0,};
int dp[11][2048] = {0,};
int node_size = 0;
int tsp(int node, int route, int start_node){
    route |= 1&lt;&lt;node;
    if(route == (1&lt;&lt;node_size)-1){
        /* dp[node][start_node] = graph[node][start_node]==0 ? INT_MAX : graph[node][start_node];
        return dp[node][start_node]; */
        return 0;
    }
    if(dp[node][route] != 0)
        return dp[node][route];
    
    int min_cost = INT_MAX;
    for(int i = 0; i&lt;node_size; i++){
        if((route &amp; (1&lt;&lt;i))==0 &amp;&amp; graph[node][i]!=0){
            int res = tsp(i, route, start_node); 
            if(res!=INT_MAX)
                min_cost = min(min_cost, graph[node][i] + res); 
        }
    }
    dp[node][route] = min_cost;
    return min_cost;
}
void solve(){
    memset(graph, 0, sizeof(graph));
    memset(dp, 0, sizeof(dp));
    points = vector&lt;pos&gt;(1);
    for(int i = 0; i&lt;h; i++){
        for(int j = 0; j&lt;w; j++){
            char ch = cin.get();
            while(ch=='\n'||ch=='\r'||ch==' ')
                ch = cin.get();
            board[i][j] = ch;
            if(ch=='o')
                points[0] = {i, j}; 
            else if(ch=='*')
                points.push_back({i, j});
        }
    }
    
    for(int i = 0; i&lt;points.size(); i++){
        bfs(i);
        /* for(int i = 0; i&lt;h; i++){
            for(int j = 0; j&lt;w; j++){
                printf(&quot;%2d&quot;, done[i][j]);
            }
            cout &lt;&lt; endl;
        }
        cout &lt;&lt; endl;
*/
        for(int j = 0; j&lt;points.size(); j++){
            if(i==j)
                continue;
            pos p = points[j]; 
            if(done[p.x][p.y]==-1){
                cout &lt;&lt; -1 &lt;&lt; '\n';
                return;
            }
            graph[i][j] = done[p.x][p.y];
        }
    }
    node_size = points.size();
    cout &lt;&lt; tsp(0, 0, 0) &lt;&lt; '\n';

    /* for(auto t: graph){
        for(auto k: t){
            printf(&quot;[%d: %d] &quot;, k.v, k.dist);
        }       
        cout &lt;&lt; endl;
    } */
    
    
}
int main(){
    ios::sync_with_stdio(0);
    cin.tie(0);
    while(1){
        cin &gt;&gt; w &gt;&gt; h;
        if(w==0&amp;&amp;h==0)
            break;
        solve(); 
    }
    return 0;
}
</code></pre>
<p>일단 로봇 청소기는 더러운 지점을 모두 방문해야 한다. 그리고 한 곳에 방문하면 다른 더러운 지점으로 이동해야 한다. 여기서 변수가 될 수 있는 것은, 더러운 지점의 방문 순서이다. 그렇기 때문에 이 문제에서는 <a href="/post/boj%202098%20%EC%99%B8%ED%8C%90%EC%9B%90%20%EC%88%9C%ED%9A%8C.html">boj 2098 외판원 순회</a> 를 이용할 수 있다.</p>
<p>먼저 로봇 청소기의 위치와 더러운 지점들의 상호 간의 최단 거리를 구해서, 그것들을 정점으로 하고 최단 거리가 간선 비용이 되는 새로운 그래프를 만든다. (더러운 지점 끼리도 최단 거리를 구해야 한다. 왜냐하면 로봇 청소기가 더러운 지점으로 이동 후 다음 더러운 지점으로 이동해야 하기 때문이다.)</p>
<p>그리고 난 뒤, 이 그래프에 외판원 순회에서 사용한 알고리즘을 적용한다. 단 로봇 청소기의 위치가 나타내는 노드를 시작 노드로 하고, 마지막 방문 노드에서 시작 노드로 향하는 비용은 더해주지 않는다.</p>
<p>사실, 노드가 최대 10개이기 때문에, 외판원 순회에서 사용한 dp 방식을 사용하지 않고 모든 순열을 순회하며 계산을 해도 시간초과가 발생하지 않는다.</p>
<h3 id="느낀점">느낀점</h3>
<p>모든 경로를 순회하면 시간초과가 발생할 것이라고 생각했지만 실제로는 그렇지 않았다. 조금 더 정확하게 살펴보아야겠다.</p>

                        </div>
                    </article>

                </div>
            </div> 
            <footer class="py-4 text-sm text-gray-700 dark:text-gray-200 text-center">
                © 2023. Taehyeon Kim All rights reserved. 
            </footer>
        </div>
    </body>
</html>
