<!DOCTYPE html>
<html lang="en">
    <head>
        <title>blog.argnmp</title>
        
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="data:,">
        <link href="/static/main.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
        <script src="/static/entry_bundle.js"></script>
        <script src="/static/module_bundle.js" type="module"></script>
    </head>
    <body class="dark:bg-gray-800">
        <div class="p-5 sm:px-10 md:px-16 lg:container mx-auto lg:px-20 py-5 xl:px-48 box-border h-screen w-screen">
            <div class="flex text-customlight-700 dark:text-customdark-400 mb-4 border-b border-customlight-700 dark:border-customdark-400">
                <div class="grow">
                    <a class="inline-block" href="/">
                        <p
                            class="text-2xl font-bold hover:bg-customlight-700 hover:text-white dark:hover:bg-customdark-400 dark:hover:text-gray-800">
                        blog.argnmp</p>
                    </a>
                </div>
                <button id="searchToggle" class="cursor-pointer justify-center items-center p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 stroke-gray-600 dark:stroke-gray-400"
                        viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
                        <path d="M21 21l-6 -6" />
                    </svg>
                </button>
                <button id="toggle" class="cursor-pointer justify-center items-center p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="dark:hidden w-4 h-4" viewBox="0 0 16 16">
                        <path class="fill-gray-600" d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden dark:block w-4 h-4" viewBox="0 0 16 16">
                        <path class="fill-gray-400" d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
                        <path class="fill-gray-400" d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
                    </svg>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-12 gap-2">
                <div class="md:col-span-3">
                    <div class="flex md:flex-col text-gray-900 dark:text-gray-200">
                        <div class="w-full md:object-center basis-1/4">
                          <img class="w-full max-w-sm mx-auto rounded-md ring-customlight-600 dark:ring-customdark-500" src="/static/profile image.png" />
                        </div>
                        <div class="grow pl-4 md:p-0 md:text-left my-auto">
                          <p class="text-xl md:mt-3 mb-2 font-bold">argnmp</p>
                          
                          <p class="text-xs">컴퓨터공학 관련 주제를 주로 다룹니다.</p>
                          
                          <p class="text-xs">argnmp@gmail.com</p>
                          
                          
                          
                          <p class="text-xs"><a class="text-xs" href="https://github.com/argnmp">github</a></p>
                          
                        </div>
                    </div>
                    <div id="toc" class="sticky top-5 mt-5 border-l-2">
                        <p class="pl-4 pb-1 text-sm text-gray-900 dark:text-gray-200 cursor-pointer hover:text-custom-light-700 dark:hover:text-custom-light-400 hover:font-bold hover:underline" hidden>to load styles for dynamically created elements</ul>
                    </div>
                </div>
                <div id="main" class="grid-flow-row md:col-span-9 rounded-lg">
                    <div id="searchModule" class="md:pl-3" hidden>
                        <div class="pb-2">
                            <form class="flex">
                                <input type="text" name="search" id="search_input" class="inline w-full rounded-md border-0 py-1 px-2 mr-2 text-gray-900 ring-1 ring-inset ring-gray-300 dark:ring-gray-700 placeholder:text-gray-400 focus:ring-1 focus:ring-inset focus:ring-customlight-600 dark:focus:ring-customdark-300 text-sm sm:leading-6 dark:bg-gray-800 dark:text-gray-200" placeholder="search for child nodes..." onkeyup="window.search()">
                            </form>
                        </div>
                        <div class="" id="search_result">
                            <a class="" href="">
                                <div class="mb-1 px-2 py-1 border border-gray-200 dark:border-gray-600 dark:text-gray-200 hidden">
                                </div> 
                            </a>
                        </div> 
                    </div>
                    
                    
                    <article>
                        <section class="w-full mb-12">
                            <div class="mb-2 md:pl-5">
                                <p class="text-4xl md:text-4xl break-keep font-semibold text-gray-700 dark:text-gray-200 py-1">boj 11658 구간 합 구하기 3</p>
                                
                            </div>
                            <div class="flex flex-row mb-4 md:pl-5 text-gray-500 dark:text-gray-400">
                                <div class="mr-2"><p class="text-xs italic">Taehyeon Kim</p></div>
                                <div class="mr-2"><p class="text-xs italic">2024-01-19</p></div>
                                <div class="bg-customlight-100 bg-customlight-200 bg-customlight-300 bg-customlight-400 bg-customlight-500 bg-customlight-600 bg-customlight-700 bg-customlight-800 bg-customlight-900 dark:bg-customdark-100 dark:bg-customdark-200 dark:bg-customdark-300 dark:bg-customdark-400 dark:bg-customdark-500 dark:bg-customdark-600 dark:bg-customdark-700 dark:bg-customdark-800 dark:bg-customdark-900" hidden></div>
                                <div class="mr-2 flex flex-row">
                                    
                                    
                                    
                                    
                                    

                                    <div class="px-1 mr-1 bg-customlight-500 dark:bg-customdark-500 align-middle text-xs text-white rounded-md">
                                        boj
                                    </div>
                                    
                                    
                                    
                                    

                                    <div class="px-1 mr-1 bg-customlight-600 dark:bg-customdark-600 align-middle text-xs text-white rounded-md">
                                        ps
                                    </div>
                                    
                                    
                                </div>
                            </div>
                        </section>
                        <div class="clear-none markdown-body mb-10 md:pl-5 leading-6 font-post">
                            <h3 id="문제">문제</h3>
<p><a href="https://www.acmicpc.net/problem/11658">https://www.acmicpc.net/problem/11658</a></p>
<h3 id="풀이">풀이</h3>
<pre><code class="language-c++">#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;climits&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;map&gt;
#include &lt;unordered_map&gt;
#include &lt;set&gt;
#include &lt;unordered_set&gt;
#include &lt;bitset&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
using namespace std;
using ll = long long;
int n, m;
ll value[1030][1030] = {0,};
ll fwt[1030][1030] = {0,};
struct pos{
    int x, y;
};
ll fwt_calc(pos t){
    ll acc = 0;
    for(int i = t.x; i&gt;0; i -= (i &amp; -i)){
        for(int j = t.y; j&gt;0; j -= (j &amp; -j)){
            acc += fwt[i][j];
        }
    } 
    return acc;
}
void fwt_update(pos t, ll diff){
    for(int i = t.x; i&lt;=n; i += (i &amp; -i)){
        for(int j = t.y; j&lt;=n; j += (j &amp; -j)){
            fwt[i][j] += diff;
        }
    } 
}
void solve(){
    cin &gt;&gt; n &gt;&gt; m; 
    ll t;
    for(int i = 1; i&lt;=n; i++){
        for(int j = 1; j&lt;=n; j++){
            cin &gt;&gt; t;   
            value[i][j] = t;
            fwt_update({i, j}, t);
        }
    } 
    ll w, c;
    pos a, b;
    for(int i = 0; i&lt;m; i++){
        cin &gt;&gt; w;
        if(w==0){
            cin &gt;&gt; a.x &gt;&gt; a.y &gt;&gt; c;
            fwt_update(a, c - value[a.x][a.y]);
            value[a.x][a.y] = c;
        }
        else {
            cin &gt;&gt; a.x &gt;&gt; a.y &gt;&gt; b.x &gt;&gt; b.y;
            cout &lt;&lt; fwt_calc(b) - fwt_calc({a.x-1, b.y}) - fwt_calc({b.x, a.y-1}) + fwt_calc({a.x-1, a.y-1}) &lt;&lt; '\n';
        }
    }
}
int main(){
    ios::sync_with_stdio(0);
    cin.tie(0);
    solve(); 
    return 0;
}

</code></pre>
<p>처음 풀 때에는 <a href="/post/boj%202042%20%EA%B5%AC%EA%B0%84%20%ED%95%A9%20%EA%B5%AC%ED%95%98%EA%B8%B0.html">boj 2042 구간 합 구하기</a> 에서 segment tree를 사용한 방법을 사용하였다. 계산해야 하는 구간은 2차원 배열 위의 값이기 때문에, 가운데 값을 기준으로 4개의 구간으로 나누어진다. 그래서 binary tree 대신 quad tree를 이용했다.</p>
<p>또한 더이상 4개의 구간으로 나누어지지 않는 경우는(행 또는 열의 개수가 1인 경우), 주어지는 2차원 배열이 정사각형 이기 때문에 아래와 같은 3가지 경우만 존재한다는 점을 이용했다.</p>
<pre><code class="language-shell">#case1
⬜️
⬜️

#case2
⬜️ ⬜️

#case3
⬜️
</code></pre>
<p>즉, <code>⬜️ ⬜️ ⬜️ ⬜️</code> 와 같이 구간이 나누어지는 경우는 없다.</p>
<p>이를 코드로 작성하여, 제출하였지만 boj에서는 66%에서 시간초과가 발생했다.</p>
<p>이후 검색을 해보니 2차원 fenwick tree를 이용해야 한다.</p>
<p><a href="https://www.acmicpc.net/blog/view/21">https://www.acmicpc.net/blog/view/21</a>에 fenwick tree의 자세한 설명을 확인할 수 있다.</p>
<p>segment tree에서는 구간의 합을 구하기 위해서, 부모 노드에 해당하는 구간의 반을 기준으로, 찾으려는 구간이 속해 있는 여부를 확인하여 왼쪽 자식 노드 또는 오른쪽 자식 노드로 이동한다. 즉, 구간의 반의 반에 해당하는 index를 사용하여, tree의 다음 index를 찾아나가는 것이다.</p>
<p>반면, fenwick tree에서는 구간의 합( <code>i~j</code>)을 구하기 위해서, <code>j~1</code> - <code>(i-1)~1</code> 을 계산하는 방식을 사용한다. <code>k~1</code>을 계산하기 위해서는, fenwick tree에서도 마찬가지로 구간의 합에 대한 정보가 담긴 그 다음 노드를 찾아야 한다. 방식은 segment tree와 달리 비트 연산을 사용한다.</p>
<p>이 문제에서는 2차원 fenwick tree를 사용해서 계산한다.</p>
<h3 id="느낀점">느낀점</h3>
<p>fenwick tree이 많은 다른 문제에서 segment tree보다 효율적이라고 한다. 앞서 segment tree로 푼 다른 문제들도 fenwick tree로 다시 풀어봐야 겠다.</p>

                        </div>
                    </article>

                </div>
            </div> 
            <footer class="py-4 text-sm text-gray-700 dark:text-gray-200 text-center">
                © 2023. Taehyeon Kim All rights reserved. 
            </footer>
        </div>
    </body>
</html>
